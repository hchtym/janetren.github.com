CREATE OR REPLACE TRIGGER TG_DOORDTL  before insert or update on ykt_cur.t_doordtl    REFERENCING OLD AS old_doordtl    NEW AS new_doordtl  for each row when (new_doordtl.sysid=5 or new_doordtl.sysid=6 or new_doordtl.sysid is null)declare  userid number;begin  :new_doordtl.cardphyid :=upper(:new_doordtl.cardphyid);  select deviceid,sysid into :new_doordtl.deviceid,:new_doordtl.sysid from t_device where devphyid=:new_doordtl.devphyid;  if (:new_doordtl.coldate is null) then     select to_char(sysdate,'yyyymmdd') into :new_doordtl.coldate from dual;  end if;  if (:new_doordtl.coltime is null) then     select to_char(sysdate,'hh24miss') into :new_doordtl.coltime from dual;  end if;  if ((:new_doordtl.custid=0) or (:new_doordtl.custid is null)) then     select a.cardno,a.showcardno,a.custid into :new_doordtl.cardno,:new_doordtl.showcardno,userid from (select *  from t_card where cardphyid=:new_doordtl.cardphyid order by cardno desc) a where rownum<2;    select custname,custid,stuempno into :new_doordtl.custname,:new_doordtl.custid,:new_doordtl.stuempno from t_customer where custid=userid;  end if;end TG_DOORDTL;